version: "v1.0"
name: Python Example
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: Tests
    task:
      prologue:
        commands:
          - checkout
          - sudo mkdir .pip_cache
          - sudo cache restore v3-pip-$(checksum requirements.txt)
          - sudo pip install --cache-dir .pip_cache -r requirements.txt
          - sudo store v3-pip-$(checksum requirements.txt) .pip_cache
      jobs:
        - name: Everything
          commands:
            - py.test
